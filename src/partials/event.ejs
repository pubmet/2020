<%
  if (event.id) {
    if (!events[event.id]) {
      throw new Error(`Could not find event "${event.id}"`)
    }
    event = { ...events[event.id], ...event }
  }
%>

<li class="sm:flex">
  <div class="event-indent text-gray-600">
    <% if (event.from && event.to) { %>
      <time datetime="<%= day.date %>T<%= event.from %>">
        <%= event.from %>
      </time>
      â€“
      <time datetime="<%= day.date %>T<%= event.to %>">
        <%= event.to %>
      </time>
    <% } %>
  </div>
  <div>
    <% if (event.type) { %>
      <span class="font-bold"><%= event.organizer ? `${event.type} (${event.organizer})` : event.type %></span><%= event.title ? ':' : '' %>
    <% } %>
    <% if (event.title) { %>
      <% if (event.keynote && event.presenters) { %>
        <%- findPerson(event.presenters[0]) %>:
      <% } %>
      <% if (event.id) { %>
        <a class="link" href="/programme/<%= event.id %>">
          <%= event.title %>
        </a>
      <% } else { %>
        <span class="<%= event.class %>"><%= event.title %></span>
      <% } %>
    <% } %>
    <% if (event.presenters && !event.keynote) { %>
      <div class="text-sm text-gray-800">
        <%= capitalize(pluralize(event.presenterType || 'speaker', event.presenters.length)) %>:
        <% if (event.presenters.length > 1) { %>
          <ul class="list-disc pl-6">
            <% event.presenters.map(findPerson).forEach(person => { %>
              <li><%- person %></li>
            <% }) %>
          </ul>
        <% } else { %>
          <%- findPerson(event.presenters[0]) %>
        <% } %>
      </div>
    <% } %>
    <% if (event.moderators) { %>
      <div class="text-sm text-gray-800">
        <%= pluralize('Moderator', event.moderators.length) %>:
        <% if (event.moderators.length > 1) { %>
          <ul class="list-disc pl-6">
            <% event.moderators.map(findPerson).forEach(person => { %>
              <li><%- person %></li>
            <% }) %>
          </ul>
        <% } else { %>
          <%- findPerson(event.moderators[0]) %>
        <% } %>
      </div>
    <% } %>
  </div>
</li>
